"use strict";

function ShopList() {
  this.init();
}

ShopList.prototype = {
  constructor: ShopList,
  init: function init() {
    $("#page1").load("../../dist/html/pubhead.html");
    $("#page2").load("../../dist/html/pubfooter.html");

    window.onload = function () {
      function convertStrToObj(str) {
        if (!str) {
          return {};
        }

        return JSON.parse(str);
      }

      var num = document.querySelector('b');
      var storage = window.localStorage;
      var storage_str = storage.getItem('carts') ? storage.getItem('carts') : ''; //转对象

      var storage_obj = convertStrToObj(storage_str);
      var sum = 0; //遍历对象

      for (var key in storage_obj) {
        sum += storage_obj[key].num;
      }

      num.innerText = "".concat(sum); // console.log(num);

      num.parentNode.onclick = function () {
        location.href = '../../dist/html/index04.html';
      };

      var big = document.querySelector('.big-cate');
      var list = document.querySelector('.list');
      console.log(list);

      big.onmouseover = function () {
        list.style.display = 'block';
      };

      list.onmouseover = function () {
        list.style.display = 'block';
      };

      big.onmouseout = function () {
        list.style.display = 'none';
      };

      list.onmouseout = function () {
        list.style.display = 'none';
      };

      $.get("../../dist/JSON/index.json", function (date) {
        var $arr = date;

        for (var _key in $arr) {
          $('.shopList').append( // 用地址可以访问 但是调用JSON就不能访问
          "\n                        <div class=\"col-md-2 shop shop-1\">\n                <div class=\"pic\">\n                    <a href=\"../../dist/html/index03.html\">\n                        <img src=\"".concat($arr[_key].src, "\"\n                            class=\"advertising\">\n                    </a>\n                    <a href=\"javascript:;\" class=\"get-cart\">\n                        \u52A0\u5165\u8D2D\u7269\u8F66\n                    </a>\n                </div>\n                <div class=\"caption\">\n                    <a href=\"\" class=\"name\">\n                        ").concat($arr[_key].namef, "\n                        <span class=\"highlight\">\n                            \u5929\u673A\n                        </span>\n                        ").concat($arr[_key].name, "\n                    </a>\n                    <div class=\"price\">\n                        \uFFE5").concat($arr[_key].price, "\n                    </div>\n                    <div class=\"promotion\">\n                        <span class=\"discount-tag\" style=\"").concat($arr[_key].style, "\">").concat($arr[_key].act, "</span>\n                    </div>\n                </div>\n            </div>\n                        "));
        }
      });
    };
  }
};
new ShopList();